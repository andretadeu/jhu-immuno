# -*- coding: utf-8 -*-
"""
Created on Tue Sep 22 13:49:37 2015

@author: brian
"""

import pandas as pd

props = pd.read_csv('../data/peptide_9_props_norm.csv')



immun = pd.read_excel('../input/journal.pcbi.1003266.s001-2.XLS')
# understanding the apply method
immun['length'] = immun.Peptide.apply(len)

immun = immun[immun.length ==9]


both =  pd.merge(props, immun, left_on='PEPTIDE', right_on='Peptide')
both= both[both.Species=='Mus'] 

train = both

train['y']=train.Immunogenicity.map({'non-immunogenic':0, 'immunogenic':1})

# dum2=pd.get_dummies(train.MHC)

# pd.concat(dum2,train)

train = train.drop(['response','Immunogenicity','PEPTIDE','Peptide','Species','MHC','Unnamed: 4898'],axis=1)
train = train .drop(['Pos1_Prop001',	'Pos1_Prop002',	'Pos1_Prop003',	'Pos1_Prop004',	'Pos1_Prop005',	'Pos1_Prop006',	'Pos1_Prop007',	'Pos1_Prop008',	'Pos1_Prop009',	'Pos1_Prop010',	'Pos1_Prop011',	'Pos1_Prop012',	'Pos1_Prop013',	'Pos1_Prop014',	'Pos1_Prop015',	'Pos1_Prop016',	'Pos1_Prop017',	'Pos1_Prop018',	'Pos1_Prop019',	'Pos1_Prop020',	'Pos1_Prop021',	'Pos1_Prop022',	'Pos1_Prop023',	'Pos1_Prop024',	'Pos1_Prop025',	'Pos1_Prop026',	'Pos1_Prop027',	'Pos1_Prop028',	'Pos1_Prop029',	'Pos1_Prop030',	'Pos1_Prop031',	'Pos1_Prop032',	'Pos1_Prop033',	'Pos1_Prop034',	'Pos1_Prop035',	'Pos1_Prop036',	'Pos1_Prop037',	'Pos1_Prop038',	'Pos1_Prop039',	'Pos1_Prop040',	'Pos1_Prop041',	'Pos1_Prop042',	'Pos1_Prop043',	'Pos1_Prop044',	'Pos1_Prop045',	'Pos1_Prop046',	'Pos1_Prop047',	'Pos1_Prop048',	'Pos1_Prop049',	'Pos1_Prop050',	'Pos1_Prop051',	'Pos1_Prop052',	'Pos1_Prop053',	'Pos1_Prop054',	'Pos1_Prop055',	'Pos1_Prop056',	'Pos1_Prop057',	'Pos1_Prop058',	'Pos1_Prop059',	'Pos1_Prop060',	'Pos1_Prop061',	'Pos1_Prop062',	'Pos1_Prop063',	'Pos1_Prop064',	'Pos1_Prop065',	'Pos1_Prop066',	'Pos1_Prop067',	'Pos1_Prop068',	'Pos1_Prop069',	'Pos1_Prop070',	'Pos1_Prop071',	'Pos1_Prop072',	'Pos1_Prop073',	'Pos1_Prop074',	'Pos1_Prop075',	'Pos1_Prop076',	'Pos1_Prop077',	'Pos1_Prop078',	'Pos1_Prop079',	'Pos1_Prop080',	'Pos1_Prop081',	'Pos1_Prop082',	'Pos1_Prop083',	'Pos1_Prop084',	'Pos1_Prop085',	'Pos1_Prop086',	'Pos1_Prop087',	'Pos1_Prop088',	'Pos1_Prop089',	'Pos1_Prop090',	'Pos1_Prop091',	'Pos1_Prop092',	'Pos1_Prop093',	'Pos1_Prop094',	'Pos1_Prop095',	'Pos1_Prop096',	'Pos1_Prop097',	'Pos1_Prop098',	'Pos1_Prop099',	'Pos1_Prop100',	'Pos1_Prop101',	'Pos1_Prop102',	'Pos1_Prop103',	'Pos1_Prop104',	'Pos1_Prop105',	'Pos1_Prop106',	'Pos1_Prop107',	'Pos1_Prop108',	'Pos1_Prop109',	'Pos1_Prop110',	'Pos1_Prop111',	'Pos1_Prop112',	'Pos1_Prop113',	'Pos1_Prop114',	'Pos1_Prop115',	'Pos1_Prop116',	'Pos1_Prop117',	'Pos1_Prop118',	'Pos1_Prop119',	'Pos1_Prop120',	'Pos1_Prop121',	'Pos1_Prop122',	'Pos1_Prop123',	'Pos1_Prop124',	'Pos1_Prop125',	'Pos1_Prop126',	'Pos1_Prop127',	'Pos1_Prop128',	'Pos1_Prop129',	'Pos1_Prop130',	'Pos1_Prop131',	'Pos1_Prop132',	'Pos1_Prop133',	'Pos1_Prop134',	'Pos1_Prop135',	'Pos1_Prop136',	'Pos1_Prop137',	'Pos1_Prop138',	'Pos1_Prop139',	'Pos1_Prop140',	'Pos1_Prop141',	'Pos1_Prop142',	'Pos1_Prop143',	'Pos1_Prop144',	'Pos1_Prop145',	'Pos1_Prop146',	'Pos1_Prop147',	'Pos1_Prop148',	'Pos1_Prop149',	'Pos1_Prop150',	'Pos1_Prop151',	'Pos1_Prop152',	'Pos1_Prop153',	'Pos1_Prop154',	'Pos1_Prop155',	'Pos1_Prop156',	'Pos1_Prop157',	'Pos1_Prop158',	'Pos1_Prop159',	'Pos1_Prop160',	'Pos1_Prop161',	'Pos1_Prop162',	'Pos1_Prop163',	'Pos1_Prop164',	'Pos1_Prop165',	'Pos1_Prop166',	'Pos1_Prop167',	'Pos1_Prop168',	'Pos1_Prop169',	'Pos1_Prop170',	'Pos1_Prop171',	'Pos1_Prop172',	'Pos1_Prop173',	'Pos1_Prop174',	'Pos1_Prop175',	'Pos1_Prop176',	'Pos1_Prop177',	'Pos1_Prop178',	'Pos1_Prop179',	'Pos1_Prop180',	'Pos1_Prop181',	'Pos1_Prop182',	'Pos1_Prop183',	'Pos1_Prop184',	'Pos1_Prop185',	'Pos1_Prop186',	'Pos1_Prop187',	'Pos1_Prop188',	'Pos1_Prop189',	'Pos1_Prop190',	'Pos1_Prop191',	'Pos1_Prop192',	'Pos1_Prop193',	'Pos1_Prop194',	'Pos1_Prop195',	'Pos1_Prop196',	'Pos1_Prop197',	'Pos1_Prop198',	'Pos1_Prop199',	'Pos1_Prop200',	'Pos1_Prop201',	'Pos1_Prop202',	'Pos1_Prop203',	'Pos1_Prop204',	'Pos1_Prop205',	'Pos1_Prop206',	'Pos1_Prop207',	'Pos1_Prop208',	'Pos1_Prop209',	'Pos1_Prop210',	'Pos1_Prop211',	'Pos1_Prop212',	'Pos1_Prop213',	'Pos1_Prop214',	'Pos1_Prop215',	'Pos1_Prop216',	'Pos1_Prop217',	'Pos1_Prop218',	'Pos1_Prop219',	'Pos1_Prop220',	'Pos1_Prop221',	'Pos1_Prop222',	'Pos1_Prop223',	'Pos1_Prop224',	'Pos1_Prop225',	'Pos1_Prop226',	'Pos1_Prop227',	'Pos1_Prop228',	'Pos1_Prop229',	'Pos1_Prop230',	'Pos1_Prop231',	'Pos1_Prop232',	'Pos1_Prop233',	'Pos1_Prop234',	'Pos1_Prop235',	'Pos1_Prop236',	'Pos1_Prop237',	'Pos1_Prop238',	'Pos1_Prop239',	'Pos1_Prop240',	'Pos1_Prop241',	'Pos1_Prop242',	'Pos1_Prop243',	'Pos1_Prop244',	'Pos1_Prop245',	'Pos1_Prop246',	'Pos1_Prop247',	'Pos1_Prop248',	'Pos1_Prop249',	'Pos1_Prop250',	'Pos1_Prop251',	'Pos1_Prop252',	'Pos1_Prop253',	'Pos1_Prop254',	'Pos1_Prop255',	'Pos1_Prop256',	'Pos1_Prop257',	'Pos1_Prop258',	'Pos1_Prop259',	'Pos1_Prop260',	'Pos1_Prop261',	'Pos1_Prop262',	'Pos1_Prop263',	'Pos1_Prop264',	'Pos1_Prop265',	'Pos1_Prop266',	'Pos1_Prop267',	'Pos1_Prop268',	'Pos1_Prop269',	'Pos1_Prop270',	'Pos1_Prop271',	'Pos1_Prop272',	'Pos1_Prop273',	'Pos1_Prop274',	'Pos1_Prop275',	'Pos1_Prop276',	'Pos1_Prop277',	'Pos1_Prop278',	'Pos1_Prop279',	'Pos1_Prop280',	'Pos1_Prop281',	'Pos1_Prop282',	'Pos1_Prop283',	'Pos1_Prop284',	'Pos1_Prop285',	'Pos1_Prop286',	'Pos1_Prop287',	'Pos1_Prop288',	'Pos1_Prop289',	'Pos1_Prop290',	'Pos1_Prop291',	'Pos1_Prop292',	'Pos1_Prop293',	'Pos1_Prop294',	'Pos1_Prop295',	'Pos1_Prop296',	'Pos1_Prop297',	'Pos1_Prop298',	'Pos1_Prop299',	'Pos1_Prop300',	'Pos1_Prop301',	'Pos1_Prop302',	'Pos1_Prop303',	'Pos1_Prop304',	'Pos1_Prop305',	'Pos1_Prop306',	'Pos1_Prop307',	'Pos1_Prop308',	'Pos1_Prop309',	'Pos1_Prop310',	'Pos1_Prop311',	'Pos1_Prop312',	'Pos1_Prop313',	'Pos1_Prop314',	'Pos1_Prop315',	'Pos1_Prop316',	'Pos1_Prop317',	'Pos1_Prop318',	'Pos1_Prop319',	'Pos1_Prop320',	'Pos1_Prop321',	'Pos1_Prop322',	'Pos1_Prop323',	'Pos1_Prop324',	'Pos1_Prop325',	'Pos1_Prop326',	'Pos1_Prop327',	'Pos1_Prop328',	'Pos1_Prop329',	'Pos1_Prop330',	'Pos1_Prop331',	'Pos1_Prop332',	'Pos1_Prop333',	'Pos1_Prop334',	'Pos1_Prop335',	'Pos1_Prop336',	'Pos1_Prop337',	'Pos1_Prop338',	'Pos1_Prop339',	'Pos1_Prop340',	'Pos1_Prop341',	'Pos1_Prop342',	'Pos1_Prop343',	'Pos1_Prop344',	'Pos1_Prop345',	'Pos1_Prop346',	'Pos1_Prop347',	'Pos1_Prop348',	'Pos1_Prop349',	'Pos1_Prop350',	'Pos1_Prop351',	'Pos1_Prop352',	'Pos1_Prop353',	'Pos1_Prop354',	'Pos1_Prop355',	'Pos1_Prop356',	'Pos1_Prop357',	'Pos1_Prop358',	'Pos1_Prop359',	'Pos1_Prop360',	'Pos1_Prop361',	'Pos1_Prop362',	'Pos1_Prop363',	'Pos1_Prop364',	'Pos1_Prop365',	'Pos1_Prop366',	'Pos1_Prop367',	'Pos1_Prop368',	'Pos1_Prop369',	'Pos1_Prop370',	'Pos1_Prop371',	'Pos1_Prop372',	'Pos1_Prop373',	'Pos1_Prop374',	'Pos1_Prop375',	'Pos1_Prop376',	'Pos1_Prop377',	'Pos1_Prop378',	'Pos1_Prop379',	'Pos1_Prop380',	'Pos1_Prop381',	'Pos1_Prop382',	'Pos1_Prop383',	'Pos1_Prop384',	'Pos1_Prop385',	'Pos1_Prop386',	'Pos1_Prop387',	'Pos1_Prop388',	'Pos1_Prop389',	'Pos1_Prop390',	'Pos1_Prop391',	'Pos1_Prop392',	'Pos1_Prop393',	'Pos1_Prop394',	'Pos1_Prop395',	'Pos1_Prop396',	'Pos1_Prop397',	'Pos1_Prop398',	'Pos1_Prop399',	'Pos1_Prop400',	'Pos1_Prop401',	'Pos1_Prop402',	'Pos1_Prop403',	'Pos1_Prop404',	'Pos1_Prop405',	'Pos1_Prop406',	'Pos1_Prop407',	'Pos1_Prop408',	'Pos1_Prop409',	'Pos1_Prop410',	'Pos1_Prop411',	'Pos1_Prop412',	'Pos1_Prop413',	'Pos1_Prop414',	'Pos1_Prop415',	'Pos1_Prop416',	'Pos1_Prop417',	'Pos1_Prop418',	'Pos1_Prop419',	'Pos1_Prop420',	'Pos1_Prop421',	'Pos1_Prop422',	'Pos1_Prop423',	'Pos1_Prop424',	'Pos1_Prop425',	'Pos1_Prop426',	'Pos1_Prop427',	'Pos1_Prop428',	'Pos1_Prop429',	'Pos1_Prop430',	'Pos1_Prop431',	'Pos1_Prop432',	'Pos1_Prop433',	'Pos1_Prop434',	'Pos1_Prop435',	'Pos1_Prop436',	'Pos1_Prop437',	'Pos1_Prop438',	'Pos1_Prop439',	'Pos1_Prop440',	'Pos1_Prop441',	'Pos1_Prop442',	'Pos1_Prop443',	'Pos1_Prop444',	'Pos1_Prop445',	'Pos1_Prop446',	'Pos1_Prop447',	'Pos1_Prop448',	'Pos1_Prop449',	'Pos1_Prop450',	'Pos1_Prop451',	'Pos1_Prop452',	'Pos1_Prop453',	'Pos1_Prop454',	'Pos1_Prop455',	'Pos1_Prop456',	'Pos1_Prop457',	'Pos1_Prop458',	'Pos1_Prop459',	'Pos1_Prop460',	'Pos1_Prop461',	'Pos1_Prop462',	'Pos1_Prop463',	'Pos1_Prop464',	'Pos1_Prop465',	'Pos1_Prop466',	'Pos1_Prop467',	'Pos1_Prop468',	'Pos1_Prop469',	'Pos1_Prop470',	'Pos1_Prop471',	'Pos1_Prop472',	'Pos1_Prop473',	'Pos1_Prop474',	'Pos1_Prop475',	'Pos1_Prop476',	'Pos1_Prop477',	'Pos1_Prop478',	'Pos1_Prop479',	'Pos1_Prop480',	'Pos1_Prop481',	'Pos1_Prop482',	'Pos1_Prop483',	'Pos1_Prop484',	'Pos1_Prop485',	'Pos1_Prop486',	'Pos1_Prop487',	'Pos1_Prop488',	'Pos1_Prop489',	'Pos1_Prop490',	'Pos1_Prop491',	'Pos1_Prop492',	'Pos1_Prop493',	'Pos1_Prop494',	'Pos1_Prop495',	'Pos1_Prop496',	'Pos1_Prop497',	'Pos1_Prop498',	'Pos1_Prop499',	'Pos1_Prop500',	'Pos1_Prop501',	'Pos1_Prop502',	'Pos1_Prop503',	'Pos1_Prop504',	'Pos1_Prop505',	'Pos1_Prop506',	'Pos1_Prop507',	'Pos1_Prop508',	'Pos1_Prop509',	'Pos1_Prop510',	'Pos1_Prop511',	'Pos1_Prop512',	'Pos1_Prop513',	'Pos1_Prop514',	'Pos1_Prop515',	'Pos1_Prop516',	'Pos1_Prop517',	'Pos1_Prop518',	'Pos1_Prop519',	'Pos1_Prop520',	'Pos1_Prop521',	'Pos1_Prop522',	'Pos1_Prop523',	'Pos1_Prop524',	'Pos1_Prop525',	'Pos1_Prop526',	'Pos1_Prop527',	'Pos1_Prop528',	'Pos1_Prop529',	'Pos1_Prop530',	'Pos1_Prop531',	'Pos1_Prop532',	'Pos1_Prop533',	'Pos1_Prop534',	'Pos1_Prop535',	'Pos1_Prop536',	'Pos1_Prop537',	'Pos1_Prop538',	'Pos1_Prop539',	'Pos1_Prop540',	'Pos1_Prop541',	'Pos1_Prop542',	'Pos1_Prop543',	'Pos1_Prop544'],axis=1)
train = train .drop(['Pos9_Prop001',	'Pos9_Prop002',	'Pos9_Prop003',	'Pos9_Prop004',	'Pos9_Prop005',	'Pos9_Prop006',	'Pos9_Prop007',	'Pos9_Prop008',	'Pos9_Prop009',	'Pos9_Prop010',	'Pos9_Prop011',	'Pos9_Prop012',	'Pos9_Prop013',	'Pos9_Prop014',	'Pos9_Prop015',	'Pos9_Prop016',	'Pos9_Prop017',	'Pos9_Prop018',	'Pos9_Prop019',	'Pos9_Prop020',	'Pos9_Prop021',	'Pos9_Prop022',	'Pos9_Prop023',	'Pos9_Prop024',	'Pos9_Prop025',	'Pos9_Prop026',	'Pos9_Prop027',	'Pos9_Prop028',	'Pos9_Prop029',	'Pos9_Prop030',	'Pos9_Prop031',	'Pos9_Prop032',	'Pos9_Prop033',	'Pos9_Prop034',	'Pos9_Prop035',	'Pos9_Prop036',	'Pos9_Prop037',	'Pos9_Prop038',	'Pos9_Prop039',	'Pos9_Prop040',	'Pos9_Prop041',	'Pos9_Prop042',	'Pos9_Prop043',	'Pos9_Prop044',	'Pos9_Prop045',	'Pos9_Prop046',	'Pos9_Prop047',	'Pos9_Prop048',	'Pos9_Prop049',	'Pos9_Prop050',	'Pos9_Prop051',	'Pos9_Prop052',	'Pos9_Prop053',	'Pos9_Prop054',	'Pos9_Prop055',	'Pos9_Prop056',	'Pos9_Prop057',	'Pos9_Prop058',	'Pos9_Prop059',	'Pos9_Prop060',	'Pos9_Prop061',	'Pos9_Prop062',	'Pos9_Prop063',	'Pos9_Prop064',	'Pos9_Prop065',	'Pos9_Prop066',	'Pos9_Prop067',	'Pos9_Prop068',	'Pos9_Prop069',	'Pos9_Prop070',	'Pos9_Prop071',	'Pos9_Prop072',	'Pos9_Prop073',	'Pos9_Prop074',	'Pos9_Prop075',	'Pos9_Prop076',	'Pos9_Prop077',	'Pos9_Prop078',	'Pos9_Prop079',	'Pos9_Prop080',	'Pos9_Prop081',	'Pos9_Prop082',	'Pos9_Prop083',	'Pos9_Prop084',	'Pos9_Prop085',	'Pos9_Prop086',	'Pos9_Prop087',	'Pos9_Prop088',	'Pos9_Prop089',	'Pos9_Prop090',	'Pos9_Prop091',	'Pos9_Prop092',	'Pos9_Prop093',	'Pos9_Prop094',	'Pos9_Prop095',	'Pos9_Prop096',	'Pos9_Prop097',	'Pos9_Prop098',	'Pos9_Prop099',	'Pos9_Prop100',	'Pos9_Prop101',	'Pos9_Prop102',	'Pos9_Prop103',	'Pos9_Prop104',	'Pos9_Prop105',	'Pos9_Prop106',	'Pos9_Prop107',	'Pos9_Prop108',	'Pos9_Prop109',	'Pos9_Prop110',	'Pos9_Prop111',	'Pos9_Prop112',	'Pos9_Prop113',	'Pos9_Prop114',	'Pos9_Prop115',	'Pos9_Prop116',	'Pos9_Prop117',	'Pos9_Prop118',	'Pos9_Prop119',	'Pos9_Prop120',	'Pos9_Prop121',	'Pos9_Prop122',	'Pos9_Prop123',	'Pos9_Prop124',	'Pos9_Prop125',	'Pos9_Prop126',	'Pos9_Prop127',	'Pos9_Prop128',	'Pos9_Prop129',	'Pos9_Prop130',	'Pos9_Prop131',	'Pos9_Prop132',	'Pos9_Prop133',	'Pos9_Prop134',	'Pos9_Prop135',	'Pos9_Prop136',	'Pos9_Prop137',	'Pos9_Prop138',	'Pos9_Prop139',	'Pos9_Prop140',	'Pos9_Prop141',	'Pos9_Prop142',	'Pos9_Prop143',	'Pos9_Prop144',	'Pos9_Prop145',	'Pos9_Prop146',	'Pos9_Prop147',	'Pos9_Prop148',	'Pos9_Prop149',	'Pos9_Prop150',	'Pos9_Prop151',	'Pos9_Prop152',	'Pos9_Prop153',	'Pos9_Prop154',	'Pos9_Prop155',	'Pos9_Prop156',	'Pos9_Prop157',	'Pos9_Prop158',	'Pos9_Prop159',	'Pos9_Prop160',	'Pos9_Prop161',	'Pos9_Prop162',	'Pos9_Prop163',	'Pos9_Prop164',	'Pos9_Prop165',	'Pos9_Prop166',	'Pos9_Prop167',	'Pos9_Prop168',	'Pos9_Prop169',	'Pos9_Prop170',	'Pos9_Prop171',	'Pos9_Prop172',	'Pos9_Prop173',	'Pos9_Prop174',	'Pos9_Prop175',	'Pos9_Prop176',	'Pos9_Prop177',	'Pos9_Prop178',	'Pos9_Prop179',	'Pos9_Prop180',	'Pos9_Prop181',	'Pos9_Prop182',	'Pos9_Prop183',	'Pos9_Prop184',	'Pos9_Prop185',	'Pos9_Prop186',	'Pos9_Prop187',	'Pos9_Prop188',	'Pos9_Prop189',	'Pos9_Prop190',	'Pos9_Prop191',	'Pos9_Prop192',	'Pos9_Prop193',	'Pos9_Prop194',	'Pos9_Prop195',	'Pos9_Prop196',	'Pos9_Prop197',	'Pos9_Prop198',	'Pos9_Prop199',	'Pos9_Prop200',	'Pos9_Prop201',	'Pos9_Prop202',	'Pos9_Prop203',	'Pos9_Prop204',	'Pos9_Prop205',	'Pos9_Prop206',	'Pos9_Prop207',	'Pos9_Prop208',	'Pos9_Prop209',	'Pos9_Prop210',	'Pos9_Prop211',	'Pos9_Prop212',	'Pos9_Prop213',	'Pos9_Prop214',	'Pos9_Prop215',	'Pos9_Prop216',	'Pos9_Prop217',	'Pos9_Prop218',	'Pos9_Prop219',	'Pos9_Prop220',	'Pos9_Prop221',	'Pos9_Prop222',	'Pos9_Prop223',	'Pos9_Prop224',	'Pos9_Prop225',	'Pos9_Prop226',	'Pos9_Prop227',	'Pos9_Prop228',	'Pos9_Prop229',	'Pos9_Prop230',	'Pos9_Prop231',	'Pos9_Prop232',	'Pos9_Prop233',	'Pos9_Prop234',	'Pos9_Prop235',	'Pos9_Prop236',	'Pos9_Prop237',	'Pos9_Prop238',	'Pos9_Prop239',	'Pos9_Prop240',	'Pos9_Prop241',	'Pos9_Prop242',	'Pos9_Prop243',	'Pos9_Prop244',	'Pos9_Prop245',	'Pos9_Prop246',	'Pos9_Prop247',	'Pos9_Prop248',	'Pos9_Prop249',	'Pos9_Prop250',	'Pos9_Prop251',	'Pos9_Prop252',	'Pos9_Prop253',	'Pos9_Prop254',	'Pos9_Prop255',	'Pos9_Prop256',	'Pos9_Prop257',	'Pos9_Prop258',	'Pos9_Prop259',	'Pos9_Prop260',	'Pos9_Prop261',	'Pos9_Prop262',	'Pos9_Prop263',	'Pos9_Prop264',	'Pos9_Prop265',	'Pos9_Prop266',	'Pos9_Prop267',	'Pos9_Prop268',	'Pos9_Prop269',	'Pos9_Prop270',	'Pos9_Prop271',	'Pos9_Prop272',	'Pos9_Prop273',	'Pos9_Prop274',	'Pos9_Prop275',	'Pos9_Prop276',	'Pos9_Prop277',	'Pos9_Prop278',	'Pos9_Prop279',	'Pos9_Prop280',	'Pos9_Prop281',	'Pos9_Prop282',	'Pos9_Prop283',	'Pos9_Prop284',	'Pos9_Prop285',	'Pos9_Prop286',	'Pos9_Prop287',	'Pos9_Prop288',	'Pos9_Prop289',	'Pos9_Prop290',	'Pos9_Prop291',	'Pos9_Prop292',	'Pos9_Prop293',	'Pos9_Prop294',	'Pos9_Prop295',	'Pos9_Prop296',	'Pos9_Prop297',	'Pos9_Prop298',	'Pos9_Prop299',	'Pos9_Prop300',	'Pos9_Prop301',	'Pos9_Prop302',	'Pos9_Prop303',	'Pos9_Prop304',	'Pos9_Prop305',	'Pos9_Prop306',	'Pos9_Prop307',	'Pos9_Prop308',	'Pos9_Prop309',	'Pos9_Prop310',	'Pos9_Prop311',	'Pos9_Prop312',	'Pos9_Prop313',	'Pos9_Prop314',	'Pos9_Prop315',	'Pos9_Prop316',	'Pos9_Prop317',	'Pos9_Prop318',	'Pos9_Prop319',	'Pos9_Prop320',	'Pos9_Prop321',	'Pos9_Prop322',	'Pos9_Prop323',	'Pos9_Prop324',	'Pos9_Prop325',	'Pos9_Prop326',	'Pos9_Prop327',	'Pos9_Prop328',	'Pos9_Prop329',	'Pos9_Prop330',	'Pos9_Prop331',	'Pos9_Prop332',	'Pos9_Prop333',	'Pos9_Prop334',	'Pos9_Prop335',	'Pos9_Prop336',	'Pos9_Prop337',	'Pos9_Prop338',	'Pos9_Prop339',	'Pos9_Prop340',	'Pos9_Prop341',	'Pos9_Prop342',	'Pos9_Prop343',	'Pos9_Prop344',	'Pos9_Prop345',	'Pos9_Prop346',	'Pos9_Prop347',	'Pos9_Prop348',	'Pos9_Prop349',	'Pos9_Prop350',	'Pos9_Prop351',	'Pos9_Prop352',	'Pos9_Prop353',	'Pos9_Prop354',	'Pos9_Prop355',	'Pos9_Prop356',	'Pos9_Prop357',	'Pos9_Prop358',	'Pos9_Prop359',	'Pos9_Prop360',	'Pos9_Prop361',	'Pos9_Prop362',	'Pos9_Prop363',	'Pos9_Prop364',	'Pos9_Prop365',	'Pos9_Prop366',	'Pos9_Prop367',	'Pos9_Prop368',	'Pos9_Prop369',	'Pos9_Prop370',	'Pos9_Prop371',	'Pos9_Prop372',	'Pos9_Prop373',	'Pos9_Prop374',	'Pos9_Prop375',	'Pos9_Prop376',	'Pos9_Prop377',	'Pos9_Prop378',	'Pos9_Prop379',	'Pos9_Prop380',	'Pos9_Prop381',	'Pos9_Prop382',	'Pos9_Prop383',	'Pos9_Prop384',	'Pos9_Prop385',	'Pos9_Prop386',	'Pos9_Prop387',	'Pos9_Prop388',	'Pos9_Prop389',	'Pos9_Prop390',	'Pos9_Prop391',	'Pos9_Prop392',	'Pos9_Prop393',	'Pos9_Prop394',	'Pos9_Prop395',	'Pos9_Prop396',	'Pos9_Prop397',	'Pos9_Prop398',	'Pos9_Prop399',	'Pos9_Prop400',	'Pos9_Prop401',	'Pos9_Prop402',	'Pos9_Prop403',	'Pos9_Prop404',	'Pos9_Prop405',	'Pos9_Prop406',	'Pos9_Prop407',	'Pos9_Prop408',	'Pos9_Prop409',	'Pos9_Prop410',	'Pos9_Prop411',	'Pos9_Prop412',	'Pos9_Prop413',	'Pos9_Prop414',	'Pos9_Prop415',	'Pos9_Prop416',	'Pos9_Prop417',	'Pos9_Prop418',	'Pos9_Prop419',	'Pos9_Prop420',	'Pos9_Prop421',	'Pos9_Prop422',	'Pos9_Prop423',	'Pos9_Prop424',	'Pos9_Prop425',	'Pos9_Prop426',	'Pos9_Prop427',	'Pos9_Prop428',	'Pos9_Prop429',	'Pos9_Prop430',	'Pos9_Prop431',	'Pos9_Prop432',	'Pos9_Prop433',	'Pos9_Prop434',	'Pos9_Prop435',	'Pos9_Prop436',	'Pos9_Prop437',	'Pos9_Prop438',	'Pos9_Prop439',	'Pos9_Prop440',	'Pos9_Prop441',	'Pos9_Prop442',	'Pos9_Prop443',	'Pos9_Prop444',	'Pos9_Prop445',	'Pos9_Prop446',	'Pos9_Prop447',	'Pos9_Prop448',	'Pos9_Prop449',	'Pos9_Prop450',	'Pos9_Prop451',	'Pos9_Prop452',	'Pos9_Prop453',	'Pos9_Prop454',	'Pos9_Prop455',	'Pos9_Prop456',	'Pos9_Prop457',	'Pos9_Prop458',	'Pos9_Prop459',	'Pos9_Prop460',	'Pos9_Prop461',	'Pos9_Prop462',	'Pos9_Prop463',	'Pos9_Prop464',	'Pos9_Prop465',	'Pos9_Prop466',	'Pos9_Prop467',	'Pos9_Prop468',	'Pos9_Prop469',	'Pos9_Prop470',	'Pos9_Prop471',	'Pos9_Prop472',	'Pos9_Prop473',	'Pos9_Prop474',	'Pos9_Prop475',	'Pos9_Prop476',	'Pos9_Prop477',	'Pos9_Prop478',	'Pos9_Prop479',	'Pos9_Prop480',	'Pos9_Prop481',	'Pos9_Prop482',	'Pos9_Prop483',	'Pos9_Prop484',	'Pos9_Prop485',	'Pos9_Prop486',	'Pos9_Prop487',	'Pos9_Prop488',	'Pos9_Prop489',	'Pos9_Prop490',	'Pos9_Prop491',	'Pos9_Prop492',	'Pos9_Prop493',	'Pos9_Prop494',	'Pos9_Prop495',	'Pos9_Prop496',	'Pos9_Prop497',	'Pos9_Prop498',	'Pos9_Prop499',	'Pos9_Prop500',	'Pos9_Prop501',	'Pos9_Prop502',	'Pos9_Prop503',	'Pos9_Prop504',	'Pos9_Prop505',	'Pos9_Prop506',	'Pos9_Prop507',	'Pos9_Prop508',	'Pos9_Prop509',	'Pos9_Prop510',	'Pos9_Prop511',	'Pos9_Prop512',	'Pos9_Prop513',	'Pos9_Prop514',	'Pos9_Prop515',	'Pos9_Prop516',	'Pos9_Prop517',	'Pos9_Prop518',	'Pos9_Prop519',	'Pos9_Prop520',	'Pos9_Prop521',	'Pos9_Prop522',	'Pos9_Prop523',	'Pos9_Prop524',	'Pos9_Prop525',	'Pos9_Prop526',	'Pos9_Prop527',	'Pos9_Prop528',	'Pos9_Prop529',	'Pos9_Prop530',	'Pos9_Prop531',	'Pos9_Prop532',	'Pos9_Prop533',	'Pos9_Prop534',	'Pos9_Prop535',	'Pos9_Prop536',	'Pos9_Prop537',	'Pos9_Prop538',	'Pos9_Prop539',	'Pos9_Prop540',	'Pos9_Prop541',	'Pos9_Prop542',	'Pos9_Prop543',	'Pos9_Prop544'],axis=1)
y = train.y
X = train.drop(['y'],axis=1)




# TASK 3: split the data into training and testing sets
from sklearn.cross_validation import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=1)

# TASK 4: fit a logistic regression model and examine the coefficients
from sklearn.ensemble import RandomForestClassifier



rf = RandomForestClassifier()
rf.fit(X_train, y_train)
rfProp =zip(X.columns, rf.feature_importances_)
pd.DataFrame(rfProp).to_clipboard()


from sklearn import metrics 
# predict and calculate AUC 
y_pred_prob = rf.predict_proba(X_test)[:, 1]

y_pred_class = rf.predict(X_test) 

print metrics.roc_auc_score(y_test, y_pred_prob)
# 0.858192133098 with Tdf vectorizer and stop_words='english',ngram_range=(1, 2), max_features=1000
# 0.846367492831 adding 'OL_GENERAL','INSITE_PAGE','BROWSER_OS','BROWSER2'
# 0.846423953016 ngram_range=(1,3)
# 0.810 max_feature 100
# 0.8399 rang=(1,4) max features 2000
print metrics.accuracy_score(y_test, y_pred_class)
# 74.7% with CountVectorizer() 
# 65%
# 76% with TfidfVectorizer(stop_words='english',ngram_range=(1, 2), max_features=1000) 
confusion = metrics.confusion_matrix(y_test, y_pred_class)
print  confusion
sensitivity =float(confusion[1,1])/(confusion[1,0] + confusion[1,1])
print 'sensitivity is %f' % sensitivity
# sensitivity is 50, 56% with CountVectorizer() 

#Q why is sensitivity .09 with tdf if
specificity =float(confusion[0,0])/(confusion[0,0] + confusion[0,1])
print 'specificity is %f' % specificity


import matplotlib.pyplot as plt
fpr, tpr, thresholds = metrics.roc_curve(y_test, y_pred_prob)
plt.xlim([0.0, 1.0])
plt.ylim([0.0, 1.0])
plt.xlabel('False Positive Rate (1 - Specificity)')
plt.ylabel('True Positive Rate (Sensitivity)')
plt.plot(fpr, tpr)







